<th:block layout:decorate="~{layout/base}">
    <th:block layout:fragment="content">
        <nav>
            <p class="navigation">
                <a th:href="@{/tenants}">入居者一覧</a> &gt; 
                <span th:text="${tenant.id == null ? '入居者登録' : '入居者編集'}">
                    入居者フォーム
                </span>
            </p>
        </nav>

        <div class="form-container">
            <h2 th:text="${tenant.id == null ? '入居者登録' : '入居者編集'}">
                入居者フォーム
            </h2>

                        <form th:action="@{/tenants}" method="post" th:object="${tenant}" class="property-form">
                            <input type="hidden" th:field="*{id}">

                            <div class="message error" th:if="${#fields.hasGlobalErrors()}">
                                <p th:each="err : ${#fields.globalErrors()}" th:text="${err}">
                                    システムエラー
                                </p>
                            </div>

                            <div class="form-group">
                                <label for="fullName">氏名</label>
                                <input type="text" th:field="*{fullName}"
                                       th:classappend="${#fields.hasErrors('fullName')} ? 'invalid'">
                                <div class="error-message" th:if="${#fields.hasErrors('fullName')}" th:errors="*{fullName}">
                                    氏名エラー
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="email">メールアドレス</label>
                                <input type="email" th:field="*{email}"
                                       th:classappend="${#fields.hasErrors('email')} ? 'invalid'">
                                <div class="error-message" th:if="${#fields.hasErrors('email')}" th:errors="*{email}">
                                    メールアドレスエラー
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="phone">電話番号</label>
                                <input type="tel" th:field="*{phone}">
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="button primary">保存</button>
                                <a th:href="@{/tenants}" class="button">キャンセル</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="lease-history" th:if="${tenant.id != null and leases != null}">
                <div class="section-header">
                    <h3>賃貸履歴</h3>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>物件名</th>
                            <th>状態</th>
                            <th>賃料</th>
                            <th>開始日</th>
                            <th>終了日</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="lease : ${leases}">
                            <td th:text="${lease.property.name}">物件名</td>
                            <td>
                                <span th:class="${'status-badge ' + 
                                    (lease.status == 'ACTIVE' ? 'active' : 
                                    lease.status == 'NOTICE' ? 'notice' : 'ended')}"
                                      th:text="${lease.status == 'ACTIVE' ? '契約中' : 
                                              lease.status == 'NOTICE' ? '解約予定' : '終了'}">状態</span>
                            </td>
                            <td th:text="${lease.rent}">賃料</td>
                            <td th:text="${#temporals.format(lease.startDate, 'yyyy年MM月dd日')}">
                                開始日
                            </td>
                            <td th:text="${lease.endDate != null ? 
                                #temporals.format(lease.endDate, 'yyyy年MM月dd日') : '-'}">
                                終了日
                            </td>
                        </tr>
                        <tr th:if="${#lists.isEmpty(leases)}">
                            <td colspan="5" class="text-center">賃貸履歴が見つかりません</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</body>
</html>